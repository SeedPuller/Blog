{"expireTime":9007200880603432000,"key":"transformer-remark-markdown-html-ff09173ed7a5110c05a3645f7a4740ec-gatsby-remark-imagesgatsby-remark-audiogatsby-remark-external-linksgatsby-remark-prismjs-","val":"<p>سی++ یکی از زبان هاییه که این اجازه رو به ما میده تا کلاسی که نوشتیم\nچندین کلاس والد داشته باشه یا به عبارت دیگه، قابلیت ارث بری چندگانه یا\nmultiple inheritance رو داره.</p>\n<h2>چطور استفاده می‌شه</h2>\n<p>خودِ ارث بری چندتایی خیلی عجیب غریب نیست و تنها فرقش اینه که موقع\nنوشتن کلاس، با استفاده از «کاما» میایم و Base Class هارو جدا می‌کنیم.\nمثال:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string></span></span>\n  \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Person</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">private</span><span class=\"token operator\">:</span>\n    std<span class=\"token double-colon punctuation\">::</span>string m_name<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> m_age<span class=\"token punctuation\">;</span>\n  \n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">Person</span><span class=\"token punctuation\">(</span>std<span class=\"token double-colon punctuation\">::</span>string name<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> age<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token function\">m_name</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">m_age</span><span class=\"token punctuation\">(</span>age<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n  \n    std<span class=\"token double-colon punctuation\">::</span>string <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> m_name<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">int</span> <span class=\"token function\">getAge</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> m_age<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Employee</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">private</span><span class=\"token operator\">:</span>\n    std<span class=\"token double-colon punctuation\">::</span>string m_employer<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">double</span> m_wage<span class=\"token punctuation\">;</span>\n  \n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">Employee</span><span class=\"token punctuation\">(</span>std<span class=\"token double-colon punctuation\">::</span>string employer<span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> wage<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token function\">m_employer</span><span class=\"token punctuation\">(</span>employer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">m_wage</span><span class=\"token punctuation\">(</span>wage<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n  \n    std<span class=\"token double-colon punctuation\">::</span>string <span class=\"token function\">getEmployer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> m_employer<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">double</span> <span class=\"token function\">getWage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> m_wage<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  \n<span class=\"token comment\">// Teacher publicly inherits Person and Employee</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Teacher</span><span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">Person</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">public</span> <span class=\"token class-name\">Employee</span></span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">private</span><span class=\"token operator\">:</span>\n     <span class=\"token keyword\">int</span> m_teachesGrade<span class=\"token punctuation\">;</span>\n  \n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">Teacher</span><span class=\"token punctuation\">(</span>std<span class=\"token double-colon punctuation\">::</span>string name<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> age<span class=\"token punctuation\">,</span> std<span class=\"token double-colon punctuation\">::</span>string employer<span class=\"token punctuation\">,</span> <span class=\"token keyword\">double</span> wage<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> teachesGrade<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">:</span> <span class=\"token function\">Person</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Employee</span><span class=\"token punctuation\">(</span>employer<span class=\"token punctuation\">,</span> wage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">m_teachesGrade</span><span class=\"token punctuation\">(</span>teachesGrade<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>اما بیشتر از مزایاش، چالش ها و مشکلاتش قابل بحثه!</p>\n<h2>مشکل Diamond Problem</h2>\n<p>این مشکل که به Deadly Diamond of Death هم معروفه، از این قراره که فرض\nکنید کلاس های B و C دو کلاس مجزا باشند و هر دوتاشون از کلاس A ارث بری\nکرده باشند. حالا اگر ما کلاسی مثل D داشته باشیم که به شکل همزمان از B و C\nارث بری کرده، دوبار کلاس A رو در کلاس D خواهیم داشت که این باعث مشکل\nمی‌شه.</p>\n<p><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/Diamond_inheritance.svg/220px-Diamond_inheritance.svg.png\">{: .normal}\n<em>نمایش تصویری Diamond problem. حالا دلیل اسمش معلوم شد؟ (:</em></p>\n<p>اگر تابعی مثل print در کلاس A داشته باشیم که در هیچکدوم از ارث بری ها\nبازنویسی نشده باشه و حالا از طریق کلاس D بخواد فراخوانی بشه چه اتفاقی\nمیوفته؟</p>\n<p>به ارور برمیخوریم! چون کامپایلر نمیدونه از کدوم یکی از نسخه های A که\nالآن در اختیار داره باید استفاده کنه و از کدوم مسیر باید بره. </p>\n<p>از طریق کلاس C بره و به A برسه یا از طریق کلاس B ؟</p>\n<h2>حل مسئه Diamond problem</h2>\n<p>راه حل اول اینه که دقیقا برای کامپایلر مشخص کنیم از چه مسیری باید به کلاس A برسه. مثال:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">A</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">B</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">A</span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">C</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">A</span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token comment\">// multiple inheritance </span>\n \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">D</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">B</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">public</span> <span class=\"token class-name\">C</span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n \nD object<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// explicitly determine a way to \"A\"</span>\nD<span class=\"token punctuation\">.</span><span class=\"token class-name\">B</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>یک راه دیگه هم وجود داره.</p>\n<h2>Virtual Inheritance</h2>\n<p>با استفاده از ارث بری مجازی، سی++ فقط یک نسخه از A رو به عنوان والد در نظر میگیره و نمیذاره چند نسخه از A بوجود بیاد. </p>\n<p>فقط کافیه که ارث بری‌مون رو به شکل virtual انجام بدیم:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">A</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">virtual</span> <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">B</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">virtual</span> <span class=\"token keyword\">public</span> <span class=\"token class-name\">A</span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">C</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">virtual</span> <span class=\"token keyword\">public</span> <span class=\"token class-name\">A</span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token comment\">// multiple inheritance </span>\n \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">D</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">B</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">public</span> <span class=\"token class-name\">C</span></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n \nD object<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// no need to explicit qualification</span>\nD<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>نحوه عمل کردن virtual inheritance بسیار شبیه به Virtual function ها هست که <a href=\"https://seedpuller.space/2020/05/04/what-ive-learned-from-deitel-chapter12-polymorphism/\" target=\"_blank\" rel=\"nofollow\">توی این پست</a>{align: center} درباره‌ش توضیح دادم.</p>\n<h2>در آخر</h2>\n<p>همونطور که دیدیم، ظاهرا چالش ها و مشکلات این روش بیشتر از فایده‌ش هست\nاما جاهایی هم هست که بهترین راهیه که میتونیم ازش استفاده کنیم.</p>\n<p>بهتره که تا جای ممکن سعی کنیم راه الگوریتم‌مون رو بدون استفاده از ارث\nبری چندگانه پیاده سازی بکنیم مگر اینکه پیاده سازی به این روش باعث بشه\nکه پیچیدگی کار کمتر بشه.</p>"}