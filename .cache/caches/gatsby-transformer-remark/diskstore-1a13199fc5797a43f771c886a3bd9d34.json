{"expireTime":9007200880603433000,"key":"transformer-remark-markdown-html-2c1338a9517e68c1f4be315fec4a54e4-gatsby-remark-imagesgatsby-remark-audiogatsby-remark-external-linksgatsby-remark-prismjs-","val":"<p>این فصل دربارهٔ پردازش فایل ها یا همون File Processing بود. بیشتر نکاتش رو از قبل می‌دونستم و صرفا برام مرور بود.</p>\n<h2>کلاس های مورد استفاده‌مون</h2>\n<p>برای انجام پردازش فایلی باید هدر های <code class=\"language-text\">iostream</code> و <code class=\"language-text\">fstream</code> رو اینکلود کنیم. توی <code class=\"language-text\">fstream</code> این سه تا <code class=\"language-text\">typedef</code> وجود داره:</p>\n<ul>\n<li><code class=\"language-text\">typedef basic_ifstream &lt;char> ifstream</code></li>\n<li><code class=\"language-text\">typedef basic_ofstream &lt;char> ofstream</code></li>\n<li><code class=\"language-text\">typedef basic_fstream &lt;char> fstream</code></li>\n</ul>\n<p>همونطور که می‌بینید این سه تا typdef برای نوع دادهٔ char ویژه سازی شده(specialized).</p>\n<p>توی این کلاس ها اپراتور bool هم overload شده. به این معنی که میتونیم معتبر(valid) بودن یک شئ رو به این شکل بررسی کنیم:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">fstream <span class=\"token function\">my_file</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"something.txt\"</span><span class=\"token punctuation\">,</span> ios<span class=\"token double-colon punctuation\">::</span>out<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>my_file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// do something</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>باز کردن فایل ها</h2>\n<p>برای باز کردن فایل ها چند حالت(mode) وجود داره که هرکدوم دارای ویژگی\nهای خاصی هستن. نحوه‌ی نوشتنش و اینکه هرکدومشون چه کاری انجام می‌دن پایین\nتر نوشته شده:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">ofstream <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"filename\"</span><span class=\"token punctuation\">,</span> ios<span class=\"token double-colon punctuation\">::</span>out<span class=\"token punctuation\">)</span></code></pre></div>\n<p>`<img src=\"https://seedpuller.space/wp-content/uploads/2020/05/image.png\"></p>\n<p>نکتهٔ دیگه اینکه میتونیم این حالت هارو به صورت همزمان باهم دیگه\nاستفاده بکنیم. چطوری؟ هرکدومشون رو با علامت «|»  (bitwise or) از هم جدا\nمی‌کنیم:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">ofstream <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"filename\"</span><span class=\"token punctuation\">,</span> ios<span class=\"token double-colon punctuation\">::</span>in <span class=\"token operator\">|</span> ios<span class=\"token double-colon punctuation\">::</span>out <span class=\"token operator\">|</span> ios<span class=\"token double-colon punctuation\">::</span>binary<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>پیمایش در فایل</h2>\n<p>میتونیم به سی++ بگیم که از کجای فایل میخوایم شروع کنیم به\nنوشتن/خوندن. وقتی یک فایل رو(هم برای خواندن و هم نوشتن) باز می‌کنیم، دو\nاشاره گر ایجاد میشه که به ابتدای فایل(بایت شماره صفر) اشاره می‌کنن. یکی\nاز این اشاره گر ها برای خوندن از فایل و دیگری برای نوشتن در فایل هست.\nبرای تغییر مکان اشاره گرِ خوندن، از تابع <code class=\"language-text\">seekg</code> و برای تغییر مکان اشاگر نوشتن از تابع <code class=\"language-text\">seekp</code> استفاده می‌کنیم.</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">fileObject<span class=\"token punctuation\">.</span><span class=\"token function\">seekg</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// position to the nth byte of fileObject (assumes ios::beg)</span>\nfileObject<span class=\"token punctuation\">.</span><span class=\"token function\">seekg</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> ios<span class=\"token double-colon punctuation\">::</span>cur<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// position n bytes in fileObject</span>\nfileObject<span class=\"token punctuation\">.</span><span class=\"token function\">seekg</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> ios<span class=\"token double-colon punctuation\">::</span>end<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// position n bytes back from end of fileObject</span>\nfileObject<span class=\"token punctuation\">.</span><span class=\"token function\">seekg</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> ios<span class=\"token double-colon punctuation\">::</span>end<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// position at end of fileObject</span></code></pre></div>\n<h2>خوندن و نوشتن در فایل</h2>\n<p>من خوندن و نوشتن رو از قبل بلد بودم پس اینجا فقط چیز هایی رو می‌نویسم\nکه به نظرم جالب تر بودن،‌ ممکنه یادم برن یا برام جدید بودن.</p>\n<p>فرض کنیم یه فایلی داریم که متن های داخلش به این فرمت هستند:</p>\n<p><code class=\"language-text\">100 \"some text\" 200</code></p>\n<p>همونطور که میدونیم، input stream ها اسپیس رو به عنوان کلمه‌ی کلیدی\nبرای جدا کردن آرگومان ها در نظر میگیرن. بنابراین اگر به شکل معمول زیر\nاقدام به خواندن خط بالا بکنیم، به مشکل برخواهیم خورد.</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">InputStream <span class=\"token operator\">>></span> number1 <span class=\"token operator\">>></span> text <span class=\"token operator\">>></span> number2<span class=\"token punctuation\">;</span></code></pre></div>\n<p>یکی از راه های موجود برای حل این مشکل، استفاده از یک stream manipulator به اسم <code class=\"language-text\">quoted</code> هست که در هدر <code class=\"language-text\">&lt;iomanip></code> قرار داره. حالا کدی که نوشتیم رو تغییر میدیم تا به درستی ورودی هارو از هم تشخیص بده.</p>\n<p>نکته: این ابزار مختص رشته هایی هست که داخل دو double quotation قرار داره. </p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">InputStream <span class=\"token operator\">>></span> number1 <span class=\"token operator\">>></span> <span class=\"token function\">quoted</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> number2<span class=\"token punctuation\">;</span></code></pre></div>\n<h3>خوندن و نوشتن به صورت Random-Access</h3>\n<p>نمیخوام از مزیت های این نوع دسترسی به فایل صحبت بکنم چون احساس می‌کنم\nمطلبی نبوده که به عنوان یک چیز جدید توی این کتاب یاد گرفته‌م. به همین\nحد اکتفا می‌کنم که در اکثر موارد این روش بسیار سریع تر از روش Sequential\nAccess هست. </p>\n<p>در این روش که فایل رو در حالت باینری باز می‌کنیم، باید داده هامون رو به <code class=\"language-text\">char *</code> تبدیل کنیم.</p>\n<p>اگر فرض بگیریم که <code class=\"language-text\">int number{10};</code>، برای نوشتن در فایل:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">outFile<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token generic-function\"><span class=\"token function\">reinterpret_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>و برای خوندن از فایل:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">outFile<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token generic-function\"><span class=\"token function\">reinterpret_cast</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>پارامتر اول تابع های read و write، داده ای هستن که میخوایم بنویسیم یا\nبخونیم و باید به صورت بایت به بایت خونده بشن. که برای اینکار، از <code class=\"language-text\">char*</code>استفاده می‌کنیم. پارامتر دوم همونطور که احتمالا فهمیدید، سایز داده ای هست که میخوایم بخونیم یا بنویسیم.</p>\n<p>درباره انواع cast ها در سی++ احتمالا یه پست جدا می‌نویسم!</p>\n<h2>در آخر</h2>\n<p>برای صدمین بار رها کردن مطالعه، باز اومدم. اینبار هم مثل ۹۹ بار قبلی میگم که عزم بیشتری دارم (:</p>\n<p>این فصل خیلی چیز جدیدی برام نداشت. فصل بعدی دربارهٔ کتابخانه استاندارد سی++‌ و container هاست.</p>"}